{% extends "base/base.html" %}
{% load static %}

{% block title %}Configuración de apariencia{% endblock %}

{% block content %}
<div class="owner-wrapper store-config-page">
  <div class="owner-container">
    <div class="owner-header">
      <div>
        <h1 class="owner-title">Configuración de apariencia</h1>
        <p class="owner-subtitle">Personalizá los colores y el logo de tu tienda. Los cambios se verán en tiempo real en la vista previa.</p>
      </div>

      <a href="{% url 'catalog:store_config' %}" class="owner-btn owner-btn--secondary">
        Volver
      </a>
    </div>

    <div class="store-config-layout">
      <div class="store-config-left">
        <div class="owner-card store-config-form-card">
          <form method="post" class="owner-form store-config-form" enctype="multipart/form-data">
            {% csrf_token %}

            <div class="store-config-section">
              <h2 class="store-config-section-title">Logo</h2>
              <div class="store-config-logo-row">
                <div class="store-config-logo-preview" id="preview-logo">
                  {% if logo_url %}
                  <img src="{{ logo_url }}" alt="Logo preview">
                  {% endif %}
                </div>
                <div class="store-config-field store-config-logo-field">
                  <label for="id_logo">Logo de la tienda</label>
                  <div class="store-config-logo-widget">{{ form.logo }}</div>
                </div>
              </div>
            </div>

            <div class="store-config-section">
              <h2 class="store-config-section-title">Modo claro</h2>
              <div class="store-config-color-grid">
                <div class="store-config-field" data-var="color_bg">
                  <label>{{ form.color_bg.label }}</label>
                  {{ form.color_bg }}
                </div>
                <div class="store-config-field" data-var="color_surface">
                  <label>{{ form.color_surface.label }}</label>
                  {{ form.color_surface }}
                </div>
                <div class="store-config-field" data-var="color_surface_secondary">
                  <label>{{ form.color_surface_secondary.label }}</label>
                  {{ form.color_surface_secondary }}
                </div>
                <div class="store-config-field" data-var="color_text">
                  <label>{{ form.color_text.label }}</label>
                  {{ form.color_text }}
                </div>
                <div class="store-config-field" data-var="color_primary">
                  <label>{{ form.color_primary.label }}</label>
                  {{ form.color_primary }}
                </div>
                <div class="store-config-field" data-var="color_primary_hover">
                  <label>{{ form.color_primary_hover.label }}</label>
                  {{ form.color_primary_hover }}
                </div>
                <div class="store-config-field" data-var="color_border">
                  <label>{{ form.color_border.label }}</label>
                  {{ form.color_border }}
                </div>
                <div class="store-config-field" data-var="color_muted">
                  <label>{{ form.color_muted.label }}</label>
                  {{ form.color_muted }}
                </div>
              </div>
            </div>

            <div class="store-config-section">
              <h2 class="store-config-section-title">Modo oscuro</h2>
              <div class="store-config-color-grid">
                <div class="store-config-field" data-var="color_bg_dark">
                  <label>{{ form.color_bg_dark.label }}</label>
                  {{ form.color_bg_dark }}
                </div>
                <div class="store-config-field" data-var="color_surface_dark">
                  <label>{{ form.color_surface_dark.label }}</label>
                  {{ form.color_surface_dark }}
                </div>
                <div class="store-config-field" data-var="color_surface_secondary_dark">
                  <label>{{ form.color_surface_secondary_dark.label }}</label>
                  {{ form.color_surface_secondary_dark }}
                </div>
                <div class="store-config-field" data-var="color_text_dark">
                  <label>{{ form.color_text_dark.label }}</label>
                  {{ form.color_text_dark }}
                </div>
                <div class="store-config-field" data-var="color_primary_dark">
                  <label>{{ form.color_primary_dark.label }}</label>
                  {{ form.color_primary_dark }}
                </div>
                <div class="store-config-field" data-var="color_primary_hover_dark">
                  <label>{{ form.color_primary_hover_dark.label }}</label>
                  {{ form.color_primary_hover_dark }}
                </div>
                <div class="store-config-field" data-var="color_border_dark">
                  <label>{{ form.color_border_dark.label }}</label>
                  {{ form.color_border_dark }}
                </div>
                <div class="store-config-field" data-var="color_muted_dark">
                  <label>{{ form.color_muted_dark.label }}</label>
                  {{ form.color_muted_dark }}
                </div>
              </div>
            </div>

            <div class="owner-form-actions">
              <button type="submit" class="owner-btn owner-btn--primary">
                Guardar
              </button>
              <button type="button" class="owner-btn owner-btn--secondary" id="store-config-restore-colors" aria-label="Restaurar colores por defecto">
                Restaurar colores
              </button>
              <a href="{% url 'catalog:catalog' %}" class="owner-btn owner-btn--secondary">
                Cancelar
              </a>
            </div>
          </form>
        </div>
      </div>

      <div class="store-config-right">
        <div class="owner-card store-config-preview-card">
          <div class="store-preview-panel store-preview-light" id="store-preview-light" data-theme="light">
            <h3 class="store-preview-panel-title">Modo claro</h3>
            <div class="store-preview-mockup">
              <div class="preview-header">
                <div class="preview-logo-header" data-preview-logo="light"></div>
                <span class="preview-title">Mi Tienda</span>
              </div>
              <div class="preview-content preview-catalog-layout">
                <aside class="preview-sidebar">
                  <div class="preview-sidebar-header">Filtros</div>
                  <div class="preview-filter-chips">
                    <span class="preview-filter-chip">Categoría: Electrónica</span>
                  </div>
                  <a class="preview-clear-filters" href="#" onclick="return false;">Borrar filtros</a>
                  <div class="preview-sort">
                    <select class="preview-sort-select">
                      <option>Ordenar por precio</option>
                    </select>
                  </div>
                  <h3 class="preview-categories-title">Categorías</h3>
                  <a class="preview-category-btn active" href="#">Electrónica (2)</a>
                  <a class="preview-category-btn" href="#">Hogar (1)</a>
                  <p class="preview-results-count">3 Productos</p>
                </aside>
                <div class="preview-product-card">
                  <div class="preview-product-image"></div>
                  <div class="preview-product-body">
                    <p class="preview-product-title">Producto de ejemplo</p>
                    <p class="preview-product-price">$ 1.500</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="store-preview-panel store-preview-dark" id="store-preview-dark" data-theme="dark">
            <h3 class="store-preview-panel-title">Modo oscuro</h3>
            <div class="store-preview-mockup">
              <div class="preview-header">
                <div class="preview-logo-header" data-preview-logo="dark"></div>
                <span class="preview-title">Mi Tienda</span>
              </div>
              <div class="preview-content preview-catalog-layout">
                <aside class="preview-sidebar">
                  <div class="preview-sidebar-header">Filtros</div>
                  <div class="preview-filter-chips">
                    <span class="preview-filter-chip">Categoría: Electrónica</span>
                  </div>
                  <a class="preview-clear-filters" href="#" onclick="return false;">Borrar filtros</a>
                  <div class="preview-sort">
                    <select class="preview-sort-select">
                      <option>Ordenar por precio</option>
                    </select>
                  </div>
                  <h3 class="preview-categories-title">Categorías</h3>
                  <a class="preview-category-btn active" href="#">Electrónica (2)</a>
                  <a class="preview-category-btn" href="#">Hogar (1)</a>
                  <p class="preview-results-count">3 Productos</p>
                </aside>
                <div class="preview-product-card">
                  <div class="preview-product-image"></div>
                  <div class="preview-product-body">
                    <p class="preview-product-title">Producto de ejemplo</p>
                    <p class="preview-product-price">$ 1.500</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  window.STORE_CONFIG_LOGO_URL = "{{ logo_url|default:'' }}";
</script>
<script src="{% static 'js/store_config_preview.js' %}"></script>
{% endblock %}
